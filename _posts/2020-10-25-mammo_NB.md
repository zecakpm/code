---
title: "Breast Cancer Classification with Naive Bayes"
date: 2020-10-25
tags: [machine learning, classification, Naive Bayes, data science]
header:
  image: "/images/naive_bayes/naive_bayes.jpg"
excerpt: "Data Cleaning, Machine Learning, Data Science"
---



## Naive Bayes Classifier

For this post I will explore Naive Bayes classifier to predict Breast Cancer.
Naive bayes is a supervised learning algorithim. It has as main premisse that each variable will impact on the result in an independent manner. 

Do downlood the data check out this link.

##Uderstading the data
https://archive.ics.uci.edu/ml/datasets/Mammographic+Mass


#Columns

1. BI-RADS assessment: 1 to 5 (ordinal)
2. Age: patient's age in years (integer)
3. Shape: mass shape: round=1 oval=2 lobular=3 irregular=4 (nominal)
4. Margin: mass margin: circumscribed=1 microlobulated=2 obscured=3 ill-defined=4 5. spiculated=5 (nominal)
6. Density: mass density high=1 iso=2 low=3 fat-containing=4 (ordinal)
7. Severity: benign=0 or malignant=1 (binominal)

BI-RADS will be discarted as is an assessment of serivity, variable will try to predict.

## Loading libraries and data
At this stage also renamed the columns using the data documentation.


```python
import pandas as pd
import numpy as np
import urllib
import sklearn
from sklearn.naive_bayes import MultinomialNB
from sklearn.naive_bayes import BernoulliNB
from sklearn.model_selection import train_test_split

from sklearn import metrics
from sklearn.metrics import accuracy_score


input_file ='mammographic_masses.data.txt'
df = pd.read_csv(input_file)
df.columns = ['BI-RADS','age','shape','margin','density','severity']

```

##Visualizing, cleaning, and tranforming the data

Evaluting the data set first few rows is possible to some missing values presented by "?"
At this stage is necessary the evaluation for outliers, the function min_max will select min and max values for each column, then we will be able to compare with the min and max values from the documentation.
Also lets get rid of column 'BI-RADS'.



```python
#remove missing values
df = df.replace('?',np.nan)
df = df.dropna()

#checking for outliers
def min_max (df):
    min_col = {}
    max_col = {}
    
    for col in df:
        max_col[col] = df[col].max()
        min_col[col] = df[col].min()
        
    result = pd.DataFrame([min_col,max_col])
    return result
min_max(df)

```
<img src="{{ site.url }}{{ site.baseurl }}/images/data_cleaning/2.jpg" alt="linearly separable data">


Also lets check if all the columns are intengers, this will turn out to be essencial to run the NB classifier later on.
Run the min_max function again to certify the values were removed.

```python
#checking types
df.dtypes

df= df.astype(str).astype(int) 
df = df[~(df['BI-RADS'] >= 6)]

min_max(df)

```

<img src="{{ site.url }}{{ site.baseurl }}/images/data_cleaning/2.jpg" alt="linearly separable data">

## Selecting and Spliting data
The severity column in our data set is where 

<img src="{{ site.url }}{{ site.baseurl }}/images/data_cleaning/2.jpg" alt="linearly separable data">




python
URLCounts = {}

with open(data, "r") as f:
    for line in (l.rstrip() for l in f):
        match= format_pat.match(line)
        if match:
            access = match.groupdict()
            request = access['request']
            fields = request.split()
            #code added to remove blanks and any other field with len different than 3
            if (len(fields) == 3):
                URL = fields[1]
                if URL in URLCounts:
                    URLCounts[URL] = URLCounts[URL] + 1
                else:
                    URLCounts[URL] = 1

results = sorted(URLCounts, key=lambda i: int(URLCounts[i]), reverse=True)

for result in results[:20]:
    print(result + ": " + str(URLCounts[result]))

```


<img src="{{ site.url }}{{ site.baseurl }}/images/data_cleaning/5.jpg" alt="linearly separable data">


<img src="{{ site.url }}{{ site.baseurl }}/images/data_cleaning/7.jpg" alt="linearly separable data">




